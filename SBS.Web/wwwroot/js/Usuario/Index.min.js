var usuarioJS;$(document).ready(function(){var n;n=function(){var n=this;n.Globales={BtnExportarExcel:"#btnExportarExcel"};n.Init={InicializarEventos:function(){$(document).on("click","#btnExportarExcel",n.Eventos.ExportarExcel)},InicializarAcciones:function(){n.Funciones.BuscarUsuario();n.Funciones.GrabarUsuario()}};n.Eventos={ExportarExcel:function(){const t=n.Funciones.ObtenerParametroBusqueda();console.log("param",t);n.Funciones.DescargarArchivo(t)}};n.Funciones={BuscarUsuario:function(){const t=n.Funciones.ObtenerParametroBusqueda(),i=n.Funciones.ajaxBuscarUsuario(t);console.log("listaUsuario",i)},GrabarUsuario:function(){let t={};t.RolId=0;t.CodigoUsuario="gmatos11";t.ClaveSecreta="123456";t.Email="gmatos11@pruebas.com";t.ApellidoPaterno="Matos";t.ApellidoMaterno="Camones";t.PrimerNombre="Guido";t.SegundoNombre="Alan";t.Alias="Guido Matos";const i=n.Funciones.ajaxGrabarUsuario(t);console.log("response",i)},ajaxBuscarUsuario:function(n){let t=[];return $.ajax({type:"POST",url:urlBuscarUsuario,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),"async":!1,beforeSend:function(){},success:function(n){n.success&&(t=n.data)},error:function(){},complete:function(){}}),t},ajaxGrabarUsuario:function(n){let t={success:!1,data:0};return $.ajax({type:"POST",url:urlGrabarUsuario,dataType:"json",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),"async":!1,beforeSend:function(){},success:function(n){t=n},error:function(){},complete:function(){}}),t},ObtenerParametroBusqueda:function(){let n={};return n.RolId=0,n.CodigoUsuario="gmatos",n},DescargarArchivo:function(n){$.ajax({url:urlExportarExcel,method:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(n),xhrFields:{responseType:"blob"},success:function(n,t,i){let f="",u=i.getResponseHeader("Content-Disposition");if(u&&u.indexOf("attachment")!==-1){let n=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/.exec(u);n!=null&&n[1]&&(f=n[1].replace(/['"]/g,""))}let r=document.createElement("a");r.href=window.URL.createObjectURL(n);r.download=f;document.body.append(r);r.click();window.URL.revokeObjectURL(urlExportarExcel)},complete:function(){}})}};n.Inicializar=function(){n.Init.InicializarEventos();n.Init.InicializarAcciones()}};usuarioJS=new n;usuarioJS.Inicializar()});